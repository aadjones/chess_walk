```mermaid
graph TD
    subgraph API_Layer
        get_move_stats
    end

    subgraph Divergence_Analysis
        build_move_df
        check_frequency_divergence
        check_win_rate_difference
        find_divergence
    end

    subgraph Walker_Pipeline
        choose_weighted_move
        evaluate_divergence
        validate_initial_position
        create_puzzle_data
        build_puzzle_dataframe
        save_puzzle_to_csv
        generate_and_save_puzzles
    end

    subgraph Utilities
        uci_to_san
        generate_board_svg_with_arrows
        sort_csv
        setup_logger
    end

    get_move_stats --> setup_logger
    find_divergence --> get_move_stats
    find_divergence --> build_move_df
    find_divergence --> check_frequency_divergence
    find_divergence --> check_win_rate_difference
    find_divergence --> setup_logger

    choose_weighted_move --> get_move_stats
    evaluate_divergence --> find_divergence
    evaluate_divergence --> setup_logger
    validate_initial_position --> get_move_stats
    validate_initial_position --> setup_logger
    create_puzzle_data --> setup_logger
    build_puzzle_dataframe --> setup_logger
    save_puzzle_to_csv --> sort_csv
    generate_and_save_puzzles --> choose_weighted_move
    generate_and_save_puzzles --> evaluate_divergence
    generate_and_save_puzzles --> validate_initial_position
    generate_and_save_puzzles --> create_puzzle_data
    generate_and_save_puzzles --> build_puzzle_dataframe
    generate_and_save_puzzles --> save_puzzle_to_csv
    generate_and_save_puzzles --> setup_logger
```
